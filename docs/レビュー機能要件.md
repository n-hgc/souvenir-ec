# レビュー機能要件定義

## 1. 機能概要

### 1.1 目的
お土産に特化したレビュー機能を提供し、ユーザーが「どの商品をもらって喜ばれるか」を判断できるようにする。

### 1.2 基本コンセプト
- **受け取り手の視点に特化**: もらった人の体験談を重視
- **シンプルな評価**: 3つの質問で完結
- **実用的な情報**: 贈り先の関係性と喜び度を重視

## 2. 背景・課題

### 2.1 従来のレビュー機能の問題点
- 一般的な商品レビュー（Amazon風）では、お土産特有の価値が伝わりにくい
- 「おいしい・まずい」だけでは、贈り先が喜ぶかどうかが分からない
- 贈り手の視点のみで、受け取り手の反応が分からない

### 2.2 お土産特有のニーズ
- **贈り先の関係性**: 家族・友人・恋人・職場の同僚で反応が異なる
- **シーン**: 旅行帰り・季節の挨拶・記念日など、状況によって評価が変わる
- **実用性**: 実際に使ったか、飾ったか、食べたか
- **思い出度**: 旅行の記憶と結びつくか

## 3. 機能要件

### 3.1 レビュー投稿機能

#### 3.1.1 評価項目
1. **喜び度**: 星5段階（必須）
   - 1: 喜ばれませんでした
   - 2: あまり喜ばれませんでした
   - 3: 普通でした
   - 4: 喜ばれました
   - 5: 大変喜ばれました

2. **関係性**: 選択式（必須）
   - 恋人
   - 家族
   - 友人
   - 職場の同僚

3. **コメント**: 自由記述（任意）
   - もらった時の気持ち
   - どんなシーンで贈られたか
   - 実際の使用体験

#### 3.1.2 投稿フロー
1. 商品詳細ページで「あなたの体験を投稿」をクリック
2. 3つの質問に回答
3. 投稿完了後、フォームをリセット
4. 成功メッセージを表示

### 3.2 レビュー表示機能

#### 3.2.1 商品詳細ページ
- **上部**: 総合評価（星評価 + 数値 + 評価テキスト）
- **統計セクション**: 喜び度分布、関係性別統計、おすすめ度
- **一覧表示**: フィルタリング・ソート機能付き

#### 3.2.2 商品一覧ページ
- **商品カード**: コンパクトなレビュー表示（星評価 + 数値 + 件数）
- **一目で分かる**: どの商品が喜ばれるかが即座に判断可能

### 3.3 フィルタリング・ソート機能
- **関係性フィルター**: 恋人・家族・友人・職場の同僚で絞り込み
- **ソート**: 投稿日順・喜び度順
- **統計表示**: 関係性別のレビュー数

## 4. 技術要件

### 4.1 アーキテクチャ
- **Server Component**: 商品詳細ページ（静的生成対応）
- **Client Component**: レビュー機能（インタラクティブ）
- **状態管理**: React useState（ローカル状態）

### 4.2 コンポーネント構成
```
ReviewSection.tsx          # レビュー全体セクション
├── ReviewStats.tsx        # 統計情報表示
├── ReviewForm.tsx         # 投稿フォーム
└── ReviewList.tsx         # 一覧表示

ProductRatingClient.tsx    # 商品詳細上部の評価表示
ProductCardRating.tsx      # 商品カード用の評価表示
```

### 4.3 データ構造
```typescript
interface Review {
  id: string;
  productId: number;
  joyLevel: number;        // 1-5
  relationship: '恋人' | '家族' | '友人' | '職場の同僚';
  comment?: string;
  createdAt: string;
  userName: string;
}
```

## 5. UI/UX要件

### 5.1 デザイン原則
- **シンプル**: 3つの質問で完結
- **直感的**: 星評価で感情的な反応を表現
- **視覚的**: 関係性別のアイコンとカラーコーディング
- **実用的**: 贈り先に応じた判断が可能

### 5.2 レスポンシブ対応
- モバイル・タブレット・デスクトップに対応
- 商品カードのレイアウト調整
- フォームの使いやすさを重視

### 5.3 アクセシビリティ
- 適切なラベルとフォーカス管理
- 色だけでなく、テキストでも情報を提供
- キーボードナビゲーション対応

## 6. パフォーマンス要件

### 6.1 静的生成
- 商品詳細ページは事前生成
- レビュー機能はクライアントサイドで動作
- SEOに有利な構成

### 6.2 データ管理
- 現在はサンプルデータ（ローカル状態）
- 将来的にはAPI連携を想定
- キャッシュ戦略の検討

## 7. 将来的な拡張

### 7.1 AI機能
- レビューデータを基にした商品推薦
- 予算・シーン・好みに応じた組み合わせ提案
- 季節や地域に応じたおすすめ商品の自動推薦

### 7.2 ソーシャル機能
- ユーザー間のフォロー・フォロワー
- お気に入り商品の保存
- 贈り物の履歴管理

### 7.3 分析機能
- レビューデータの詳細分析
- トレンド分析（季節・地域・関係性別）
- 売上との相関分析

## 8. 成功指標

### 8.1 ユーザーエンゲージメント
- レビュー投稿率
- ページ滞在時間
- 商品詳細ページの閲覧率

### 8.2 ビジネスインパクト
- 商品選択の精度向上
- 顧客満足度の向上
- リピート購入率の向上

### 8.3 技術指標
- ページ読み込み速度
- エラー率
- ユーザビリティテスト結果

## 9. 制約・制限事項

### 9.1 技術的制約
- Next.js 15の制限（Server ComponentからClient Componentへのイベントハンドラー渡し不可）
- 静的生成（`output: export`）との両立

### 9.2 ビジネス制約
- 現在はサンプルデータのみ
- 実際のユーザーデータの管理・プライバシー対応が必要

## 10. 実装状況

### 10.1 完了済み
- ✅ レビュー投稿フォーム
- ✅ レビュー一覧表示
- ✅ 統計情報表示
- ✅ 商品カードへの評価表示
- ✅ 商品詳細ページへの統合

### 10.2 今後の課題
- 🔄 実際のデータベース連携
- 🔄 ユーザー認証・管理
- 🔄 画像アップロード機能
- 🔄 スパム対策・モデレーション
- 🔄 多言語対応

---

**作成日**: 2024年1月
**最終更新**: 2024年1月
**作成者**: 開発チーム
**バージョン**: 1.0
